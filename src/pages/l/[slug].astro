---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import StoreButtons from '../../components/StoreButtons.astro';
import { withBase } from '../../utils/withBase';
import languageData from '../../data/languages.json';

export function getStaticPaths() {
  return languageData.languages.map(lang => ({
    params: { slug: lang.slug },
    props: { language: lang }
  }));
}

interface Props {
  language: typeof languageData.languages[0];
}

const { language } = Astro.props;
const { name, nativeName, status, appStore, playStore, wordCount } = language;

// FAQ items (shared across all languages)
const faqItems = [
  {
    question: 'What age is this app designed for?',
    answer: 'First 100 is designed for toddlers ages 1-4. The simple tap-and-listen interaction is perfect for developing language skills.'
  },
  {
    question: 'Does it work offline?',
    answer: 'Yes! All audio is included in the app. Once downloaded, no internet connection is needed.'
  },
  {
    question: 'Are there any ads or in-app purchases?',
    answer: 'No. First 100 is a one-time purchase with no ads, subscriptions, or hidden costs.'
  },
  {
    question: 'Who creates the audio?',
    answer: 'All words are recorded by native speakers to ensure authentic pronunciation.'
  }
];

// Get related languages (same first letter or nearby in alphabet)
const relatedLanguages = languageData.languages
  .filter(l => l.slug !== language.slug)
  .slice(0, 4);
const languagesPath = withBase('/languages');
---

<BaseLayout 
  title={`First Words in ${name}`}
  description={`Learn ${wordCount} first words in ${name}. Perfect for toddlers. Tap a picture, hear the word. No ads.`}
>
  <Header slot="header" currentPath={`/l/${language.slug}`} />
  
  <article class="language-detail">
    <div class="container">
      <!-- Breadcrumb -->
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href={languagesPath} class="breadcrumb__link">Languages</a>
        <span class="breadcrumb__separator" aria-hidden="true">/</span>
        <span class="breadcrumb__current">{name}</span>
      </nav>
      
      <!-- Hero Section -->
      <header class="language-hero">
        <div class="language-hero__content">
          <h1 class="language-hero__title">
            First Words in {name}
          </h1>
          {nativeName && nativeName !== name && (
            <p class="language-hero__native">{nativeName}</p>
          )}
          <p class="language-hero__description">
            Tap. Hear. Repeat. {wordCount} essential words for your toddler.
          </p>
          <div class="language-hero__actions">
            <StoreButtons 
              appStore={appStore} 
              playStore={playStore} 
              status={status}
              size="large"
            />
          </div>
        </div>
        
        <div class="language-hero__visual">
          <!-- Screenshot placeholder -->
          <div class="screenshot-strip">
            <div class="screenshot screenshot--1">
              <div class="screenshot__placeholder">
                <span>App Screenshot</span>
              </div>
            </div>
            <div class="screenshot screenshot--2">
              <div class="screenshot__placeholder">
                <span>App Screenshot</span>
              </div>
            </div>
            <div class="screenshot screenshot--3">
              <div class="screenshot__placeholder">
                <span>App Screenshot</span>
              </div>
            </div>
          </div>
        </div>
      </header>
      
      <!-- Features -->
      <section class="features">
        <div class="feature">
          <div class="feature__icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
              <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
            </svg>
          </div>
          <h3 class="feature__title">Native Audio</h3>
          <p class="feature__description">Every word spoken by a native {name} speaker.</p>
        </div>
        
        <div class="feature">
          <div class="feature__icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7"/>
              <rect x="14" y="3" width="7" height="7"/>
              <rect x="14" y="14" width="7" height="7"/>
              <rect x="3" y="14" width="7" height="7"/>
            </svg>
          </div>
          <h3 class="feature__title">{wordCount} Words</h3>
          <p class="feature__description">Essential first words organized by category.</p>
        </div>
        
        <div class="feature">
          <div class="feature__icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
          </div>
          <h3 class="feature__title">Learn Anytime</h3>
          <p class="feature__description">Works offline. No internet required.</p>
        </div>
      </section>
      
      <!-- FAQ Section -->
      <section class="faq">
        <h2 class="faq__title">Frequently Asked Questions</h2>
        <div class="faq__list">
          {faqItems.map((item) => (
            <details class="faq__item">
              <summary class="faq__question">{item.question}</summary>
              <p class="faq__answer">{item.answer}</p>
            </details>
          ))}
        </div>
      </section>
      
      <!-- Related Languages -->
      <section class="related">
        <h2 class="related__title">Explore More Languages</h2>
        <div class="related__grid">
          {relatedLanguages.map((lang) => (
            <a href={withBase(`/l/${lang.slug}`)} class="related__item">
              <span class="related__name">{lang.name}</span>
              {lang.nativeName && lang.nativeName !== lang.name && (
                <span class="related__native">{lang.nativeName}</span>
              )}
            </a>
          ))}
        </div>
        <a href={languagesPath} class="related__all">View all languages â†’</a>
      </section>
    </div>
  </article>
  
  <Footer slot="footer" />
</BaseLayout>

<style>
  .language-detail {
    padding: var(--space-8) 0 var(--space-20);
  }
  
  /* Breadcrumb */
  .breadcrumb {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    font-size: var(--font-size-sm);
    margin-bottom: var(--space-8);
  }
  
  .breadcrumb__link {
    color: var(--color-text-muted);
    text-decoration: none;
  }
  
  .breadcrumb__link:hover {
    color: var(--color-accent);
  }
  
  .breadcrumb__separator {
    color: var(--color-text-soft);
  }
  
  .breadcrumb__current {
    color: var(--color-text);
    font-weight: var(--font-weight-medium);
  }
  
  /* Hero */
  .language-hero {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-16);
    align-items: center;
    margin-bottom: var(--space-20);
  }
  
  .language-hero__title {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-bottom: var(--space-2);
  }
  
  .language-hero__native {
    font-size: var(--font-size-xl);
    color: var(--color-text-muted);
    margin-bottom: var(--space-4);
  }
  
  .language-hero__description {
    font-size: var(--font-size-lg);
    color: var(--color-text-muted);
    margin-bottom: var(--space-8);
    max-width: 400px;
  }
  
  .screenshot-strip {
    display: flex;
    gap: var(--space-4);
    justify-content: center;
  }
  
  .screenshot {
    width: 140px;
    height: 280px;
    background: var(--color-bg-alt);
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-md);
  }
  
  .screenshot--1 { transform: rotate(-5deg) translateY(10px); }
  .screenshot--2 { transform: translateY(-10px); z-index: 1; }
  .screenshot--3 { transform: rotate(5deg) translateY(10px); }
  
  .screenshot__placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-text-soft);
    font-size: var(--font-size-xs);
    text-align: center;
    padding: var(--space-4);
  }
  
  /* Features */
  .features {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--space-8);
    padding: var(--space-12) 0;
    border-top: 1px solid var(--color-border);
    border-bottom: 1px solid var(--color-border);
    margin-bottom: var(--space-16);
  }
  
  .feature {
    text-align: center;
  }
  
  .feature__icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-accent-soft);
    border-radius: var(--radius-lg);
    color: var(--color-accent);
    margin: 0 auto var(--space-4);
  }
  
  .feature__icon svg {
    width: 24px;
    height: 24px;
  }
  
  .feature__title {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
    margin-bottom: var(--space-2);
  }
  
  .feature__description {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
    margin: 0;
  }
  
  /* FAQ */
  .faq {
    margin-bottom: var(--space-16);
  }
  
  .faq__title {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
  }
  
  .faq__list {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    max-width: 700px;
  }
  
  .faq__item {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: hidden;
  }
  
  .faq__question {
    padding: var(--space-4) var(--space-5);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
    cursor: pointer;
    list-style: none;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  
  .faq__question::-webkit-details-marker {
    display: none;
  }
  
  .faq__question::after {
    content: '+';
    font-size: var(--font-size-lg);
    color: var(--color-text-muted);
    transition: transform var(--transition-fast);
  }
  
  .faq__item[open] .faq__question::after {
    transform: rotate(45deg);
  }
  
  .faq__answer {
    padding: 0 var(--space-5) var(--space-4);
    color: var(--color-text-muted);
    line-height: var(--line-height-relaxed);
    margin: 0;
  }
  
  /* Related */
  .related__title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
    margin-bottom: var(--space-6);
  }
  
  .related__grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: var(--space-4);
    margin-bottom: var(--space-6);
  }
  
  .related__item {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
    padding: var(--space-4);
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    text-decoration: none;
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
  }
  
  .related__item:hover {
    border-color: var(--color-accent-soft);
    box-shadow: var(--shadow-sm);
  }
  
  .related__name {
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
  }
  
  .related__native {
    font-size: var(--font-size-sm);
    color: var(--color-text-muted);
  }
  
  .related__all {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    color: var(--color-accent);
    text-decoration: none;
  }
  
  .related__all:hover {
    color: var(--color-accent-hover);
  }
  
  /* Responsive */
  @media (max-width: 900px) {
    .language-hero {
      grid-template-columns: 1fr;
      gap: var(--space-10);
    }
    
    .language-hero__content {
      text-align: center;
    }
    
    .language-hero__description {
      max-width: none;
    }
    
    .language-hero__actions {
      display: flex;
      justify-content: center;
    }
    
    .features {
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }
  }
  
  @media (max-width: 600px) {
    .screenshot-strip {
      display: none;
    }
    
    .language-hero__title {
      font-size: var(--font-size-3xl);
    }
  }
</style>
